DELIMITER $$DROP PROCEDURE IF EXISTS sp_populate $$CREATE PROCEDURE sp_populate () BEGIN  DECLARE iDone INTEGER (11) UNSIGNED ;  DECLARE iVersionId VARCHAR (6) ;  DECLARE iCountryId VARCHAR (5) ;  DECLARE iTeamId VARCHAR (5) ;  DECLARE iPlayerName VARCHAR (20) ;  DECLARE iMyTeamId CHAR (4) ;  DECLARE iGameType CHAR (1) ;  DECLARE iGameDateTime TIMESTAMP ;  DECLARE iHomeAway CHAR (1) ;  DECLARE iDivision TINYINT (1) ;  DECLARE iMatchAbandoned TINYINT (1) ;  DECLARE iExtraTime TINYINT (1) ;  DECLARE iGoalsFor TINYINT (1) ;  DECLARE iGoalsAgainst TINYINT (1) ;  DECLARE iGameComments TINYTEXT ;  -- this cursor returns all stats rows from the old DB.  DECLARE cStatsIterator CURSOR FOR   SELECT     versionId,    teamId,    playerName,    myTeamId,    gameType,    gameDateTime,    homeAway,    division,    matchAbandoned,    extraTime,    goalsFor,    goalsAgainst,    gameComments   FROM    fifa.`stats` ;  DECLARE CONTINUE HANDLER FOR NOT FOUND SET iDone = 1 ;  -- Step 01:   SET iDone = 0 ;  OPEN cStatsIterator ;  lStatsIterator :  LOOP    FETCH cStatsIterator INTO iVersionId,    iTeamId,    iPlayerName,    iMyTeamId,    iGameType,    iGameDateTime,    iHomeAway,    iDivision,    iMatchAbandoned,    iExtraTime,    iGoalsFor,    iGoalsAgainst,    iGameComments ;    IF 1 = iDone     THEN LEAVE lStatsIterator ;    END IF ;    SELECT       countryId INTO iCountryId     FROM      fifadev.`team`     WHERE teamId = iTeamId ;    IF iCountryId IS NOT NULL     THEN     INSERT INTO fifadev.`stats` (      `versionId`,      `teamId`,      `countryId`,      `playerName`,      `myTeamId`,      `gameType`,      `gameDateTime`,      `homeAway`,      `division`,      `matchAbandoned`,      `extraTime`,      `goalsFor`,      `goalsAgainst`,      `gameComments`    )     VALUES      (        iVersionId,        iTeamId,        iCountryId,        iPlayerName,        iMyTeamId,        iGameType,        iGameDateTime,        iHomeAway,        iDivision,        iMatchAbandoned,        iExtraTime,        iGoalsFor,        iGoalsAgainst,        iGameComments      ) ;    END IF ;  END LOOP lStatsIterator ;  CLOSE cStatsIterator ;END $$DELIMITER ;CALL sp_populate () ;